<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<!-- ////////////////////////////////////////////////////////////////////////
     // @license
     // This demo file is part of yFiles for HTML.
     // Copyright (c) by yWorks GmbH, Vor dem Kreuzberg 28,
     // 72070 Tuebingen, Germany. All rights reserved.
     //
     // yFiles demo files exhibit yFiles for HTML functionalities. Any redistribution
     // of demo files in source code or binary form, with or without
     // modification, is not permitted.
     //
     // Owners of a valid software license for a yFiles for HTML version that this
     // demo is shipped with are allowed to use the demo source code as basis
     // for their own yFiles for HTML powered applications. Use of such programs is
     // governed by the rights and conditions as set out in the yFiles for HTML
     // license agreement.
     //
     // THIS SOFTWARE IS PROVIDED ''AS IS'' AND ANY EXPRESS OR IMPLIED
     // WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
     // MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN
     // NO EVENT SHALL yWorks BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
     // SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
     // TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
     // PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
     // LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
     // NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
     // SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
     //
     ////////////////////////////////////////////////////////////////////////-->

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

    <title>Neo4j Demo [yFiles for HTML]</title>
    <script type="module" src="../../demo-app/demo-page-init.ts" async></script>

    <link rel="stylesheet" href="../../demo-app/style/demo.css" />
    <link rel="stylesheet" href="property-table.css" />

    <style>
      [hidden] {
        display: none !important;
      }

      input[type='range'] {
        vertical-align: bottom;
        width: 5em;
        height: 16px;
        padding: 0;
      }

      #login-pane {
        display: block;
        padding: 20px;
      }

      .panel {
        width: min(40rem, 100%);
        box-sizing: border-box;
        padding: 12px;
        border: 2px solid #b2bdc2;
        border-radius: 4px;
        background-color: #fff;
        z-index: 10;
      }

      .panel > :first-child {
        margin-top: 0;
      }

      .panel > :last-child {
        margin-bottom: 0;
      }

      .warning {
        margin-top: 20px;
        font-size: 18px;
        border-color: firebrick;
      }

      #login-form {
        display: flex;
        flex-direction: column;
      }

      .login-form-row {
        display: flex;
        margin-top: 10px;
      }

      .login-form-row label {
        flex: 0 0 150px;
      }

      #connectionError,
      #queryError {
        color: firebrick;
      }

      #queryError {
        margin-top: 10px;
        overflow: auto;
      }

      #queryEditorContainer .cm-editor {
        height: 300px;
        background-color: #fff;
      }
    </style>
  </head>
  <body>
    <header class="demo-header">
      <a
        href="https://www.yfiles.com"
        class="demo-header__y-logo"
        title="yFiles homepage"
        target="_blank"
      ></a>
      <div class="demo-header__breadcrumb-wrapper">
        <a href="https://www.yfiles.com/the-yfiles-sdk/web/yfiles-for-html">yFiles for HTML</a>
        <a href="../../README.html">Demos</a>

        <span>Neo4j</span>
        <a href="../../README.html" class="demo-header__mobile-back">yFiles Demos</a>
      </div>
      <div class="demo-header__right">
        <show-source-button></show-source-button>
        <fullscreen-button></fullscreen-button>
      </div>
    </header>

    <div class="demo-page__toolbar">
      <button data-command="INCREASE_ZOOM"></button>
      <button data-command="ZOOM_ORIGINAL"></button>
      <button data-command="DECREASE_ZOOM"></button>
      <button data-command="FIT_GRAPH_BOUNDS"></button>

      <span class="demo-separator"></span>
      <div class="option">
        <label for="numNodes">Maximum Node Count:</label>
        <input
          type="range"
          id="numNodes"
          value="50"
          min="50"
          max="500"
          step="50"
          class="custom-slider"
        />
        <span id="numNodesLabel">50</span>
      </div>

      <span class="demo-separator margin"></span>

      <div class="option">
        <label for="numLabels">Label Diversity:</label>
        <input type="range" id="numLabels" value="2" min="2" max="5" class="custom-slider" />
        <span id="numLabelsLabel">2</span>
      </div>
      <label>
        <input type="checkbox" checked="" id="showEdgeLabels" />
        Show Edge Labels
      </label>

      <span class="demo-separator margin"></span>

      <button id="reloadDataButton" class="demo-icon-yIconReload labeled" disabled="">
        Reload Data
      </button>
    </div>
    <aside class="demo-page__description">
      <div class="demo-description__header">
        <a
          href="https://www.yfiles.com"
          class="demo-description__logo"
          title="yFiles homepage"
          target="_blank"
        ></a>
      </div>
      <div class="demo-description__toggle-button" title="Toggle description"></div>
      <div class="demo-description__play-button">Start here</div>

      <div class="demo-description__content">
        <h1>Neo4j Demo</h1>

        <p>
          This demo shows how to load data from a Neo4j database and display it with yFiles for
          HTML.
        </p>
        <p>
          First, connect to a Neo4j database by entering a URL, a username, and a password into the
          corresponding form fields, then click the <em>Connect</em> button.
        </p>
        <p>
          After establishing a connection, a small set of data from the database will be displayed.
        </p>
        <h2>Things to Try</h2>
        <ul>
          <li>
            Explore the data: Change the viewport by dragging the canvas with the mouse and change
            the zoom level by using the mouse wheel.
          </li>
          <li>
            Click on a node to select it, which will show its labels and properties in the
            properties view on the right.
          </li>
          <li>
            Double click on a node to load more nodes that are connected to it, if any are
            available.
          </li>
          <li>
            Hover over a node to highlight the adjacent edges. Hover over an edge to highlight the
            adjacent nodes.
          </li>
          <li>Toggle the display of edge labels using the "Show Edge Labels" checkbox.</li>
          <li>
            Move the sliders for the maximum node count and label diversity and then click the
            <em>Reload Data</em> button to query the database for a new set of data. <br />
            <strong>Warning:</strong> Retrieving data with the sliders set to <em>high</em> might
            take a <em>really</em> long time (2 minutes and more) or might yield no results at all,
            depending on the database.
          </li>
          <li>
            Enter a custom Cypher query into the editor in the right, then click the "Run Cypher
            Query" button. Every node and relationship that is returned by that query will be
            visualized as a graph and will replace the current visualization.
          </li>
        </ul>

        <h2>Details</h2>
        <p>
          This demo uses the
          <a href="https://neo4j.com/docs/javascript-manual/current/" target="_blank"
            >Neo4j driver for JavaScript</a
          >
          to connect to a Neo4j database and query it for data.
        </p>
        <p>
          The query results are then used by a <a href="https://docs.yworks.com/yfileshtml/#/api/GraphBuilder" class="api" target="_blank">GraphBuilder</a> with a custom
          configuration to construct a graph from the data, while assigning different node styles to
          nodes with different labels.
        </p>
        <p>
          The maximum node count setting limits the number of nodes that are queried from the
          database, while the label diversity setting determines the length of the distinct node
          label sequences that is searched for.
        </p>
        <p>
          The graph layout is achieved by using <a href="https://docs.yworks.com/yfileshtml/#/api/OrganicLayout" class="api" target="_blank">OrganicLayout</a> with substructures
          enabled.
        </p>
      </div>
    </aside>
    <div id="login-pane" class="demo-page__main">
      <div id="login" class="panel">
        <h2>Connect to a Neo4j database</h2>
        <form id="login-form">
          <div class="login-form-row">
            <label for="hostInput">Database URL</label>
            <input
              type="text"
              id="hostInput"
              style="width: 100%"
              value="neo4j+s://demo.neo4jlabs.com:7687"
            />
          </div>
          <div class="login-form-row" style="font-size: 0.9em; margin-top: 4px">
            <label></label>
            (Supported URIs are described in the&nbsp;<a
              href="https://neo4j.com/docs/javascript-manual/current/connect-advanced/"
              target="_blank"
            >
              Neo4j documentation</a
            >)
          </div>
          <div class="login-form-row">
            <label for="databaseNameInput">Database Name</label>
            <input type="text" id="databaseNameInput" value="recommendations" />
          </div>
          <div class="login-form-row">
            <label for="userInput">Username</label>
            <input type="text" id="userInput" value="recommendations" autocomplete="username" />
          </div>
          <div class="login-form-row">
            <label for="passwordInput">Password</label>
            <input
              type="password"
              id="passwordInput"
              value="recommendations"
              autofocus=""
              autocomplete="current-password"
            />
          </div>
          <div class="login-form-row">
            <input type="submit" value="Connect" id="connect-button" />
          </div>
          <div class="login-form-row" id="connectionError"></div>
        </form>
      </div>
      <div id="openInHttp" class="panel warning" hidden>
        Connections from https to http are forbidden by the browser's security policy. If you can't
        connect to a non-encrypted database, try clicking the link below to open this tool served on
        http. <br />
        <a href=".">Open in http</a>
      </div>
      <div id="noWebSocketAPI" class="panel warning" hidden>
        <p>
          This demo application uses the <a href="https://developer.mozilla.org/docs/Web/API/WebSockets_API" target="_blank">WebSocket API</a> to
          connect to a Neo4j database, which seems to be disabled in this browser
        </p>
        <p>To use this demo, please enable it or switch to a different browser.</p>
      </div>
    </div>
    <div id="graph-pane" class="demo-page__main" hidden>
      <div class="demo-main__graph-component">
        <div id="graphComponent">
          <div id="loading-indicator">Retrieving data from the Neo4j database...</div>
        </div>
      </div>
      <aside class="demo-main__sidebar" style="--sidebar-width: 30%">
        <div class="demo-sidebar__content">
          <h2>Custom Cypher Query</h2>
          <div id="queryEditorContainer" class="editorText"></div>
          <div style="margin-top: 12px">
            <button id="run-cypher-button">Run Cypher Query</button>
            <pre id="queryError" hidden></pre>
          </div>

          <div id="selected-node-container" hidden>
            <h2>Selected Node</h2>
            <h3>Labels</h3>
            <p id="labels">None.</p>
            <h3>Properties</h3>
            <table class="property-table">
              <tbody>
                <tr>
                  <th>Name</th>
                  <th>Value</th>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </aside>
    </div>
    <script type="module" crossorigin="anonymous" src="Neo4jDemo.ts" async></script>
  </body>
</html>
